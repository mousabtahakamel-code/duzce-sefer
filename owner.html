<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Owner Paneli</title>
<style>
body{font-family:Arial;padding:20px;background:#f0f0f0;}
h2{color:#1e40af;}
input,select,button{padding:8px;margin-top:8px;width:200px;}
button{background:#2563eb;color:white;border:none;border-radius:5px;}
#sonuc{margin-top:10px;color:green;font-weight:bold;}
</style>
</head>
<body>

<script>
const aktif = JSON.parse(localStorage.getItem("aktifKullanici"));
if(!aktif || aktif.role !== "owner"){ window.location.href="index.html"; }

let users = JSON.parse(localStorage.getItem("users"));
</script>

<h2>Owner Paneli</h2>

<h3>Şifre Değiştir</h3>

<select id="kisiSec"></select><br>
<input type="password" id="yeniSifre" placeholder="Yeni Şifre"><br>
<button onclick="sifreDegistir()">Şifreyi Değiştir</button>
<p id="sonuc"></p>

<button onclick="cikis()">Çıkış Yap</button>

<script>
const sec = document.getElementById("kisiSec");

// Kullanıcı listesini doldur
users.forEach(u=>{
  // 34iett herkesin şifresini görebilir
  if(aktif.user === "34iett"){
    sec.innerHTML += `<option value="${u.user}">${u.user} (${u.role})</option>`;
  } 
  // Diğer ownerlar sadece kendini görebilir
  else if(u.user === aktif.user){
    sec.innerHTML += `<option value="${u.user}">${u.user}</option>`;
  }
});

function sifreDegistir(){
  const hedef = sec.value;
  const yeni = document.getElementById("yeniSifre").value;
  const sonuc = document.getElementById("sonuc");

  if(!yeni){
    sonuc.innerText="Şifre boş olamaz ❌";
    return;
  }

  if(hedef === "34iett"){
    sonuc.innerText="34iett şifresi değiştirilemez ❌";
    return;
  }

  if(aktif.user !== "34iett" && hedef !== aktif.user){
    sonuc.innerText="Yetkin yok ❌";
    return;
  }

  users = users.map(u=>{
    if(u.user === hedef){ u.pass = yeni; }
    return u;
  });

  localStorage.setItem("users", JSON.stringify(users));
  sonuc.innerText="Şifre değiştirildi ✅";
}

function cikis(){
  localStorage.removeItem("aktifKullanici");
  window.location.href="index.html";
}
</script>

</body>
</html>

