<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Hareket Amiri</title>
<style>
body{font-family:Arial;background:#eef;padding:20px}
.box{background:white;padding:20px;max-width:600px;margin:auto}
select,input,button{width:100%;padding:10px;margin-top:10px}
.time{padding:5px;margin:3px}
.active{background:#2563eb;color:white}
table{width:100%;margin-top:10px;border-collapse:collapse}
td,th{border:1px solid #ccc;padding:5px;text-align:center}
</style>
</head>
<body>

<div class="box">
<h3>Hareket Amiri</h3>

<select id="hat">
  <option>1 - Üniversite Ring</option>
  <option>30 - Bahçeşehir Ring</option>
  <option>12 - Yeşiltepe - Otogar - Jandarma</option>
  <option>25 - Sarayyeri - Otogar</option>
  <option>26 - Akşemsettin - Otogar</option>
  <option>46 - Mamure - Otogar</option>
  <option>43 - Düzce Üniversitesi - Bahçeşehir</option>
</select>

<select id="yon">
  <option>Gidiş</option>
  <option>Dönüş</option>
</select>

<select id="arac">
  <option>Mavi Karsan Atak</option>
  <option>Kırmızı Karsan Atak</option>
  <option>TCV Karat</option>
  <option>MAN Lions City G</option>
  <option>Mercedes Benz Conecto 2024</option>
  <option>Otokar Sultan</option>
  <option>BMC Procity TR</option>
</select>

<select id="sofor"></select>

<h4>Saatler</h4>
<div id="saatler"></div>

<button onclick="ata()">Sefer Ata</button>

<hr>

<h4>Şoför Ekle</h4>
<input id="su" placeholder="Kullanıcı adı">
<input id="sp" placeholder="PIN">
<button onclick="ekle()">Şoför Ekle</button>

<hr>

<h4>Gidiş Seferleri</h4>
<table id="gTablo"></table>

<h4>Dönüş Seferleri</h4>
<table id="dTablo"></table>

<button onclick="cikis()">Çıkış</button>
</div>

<script>
let users=JSON.parse(localStorage.getItem("users"));
let seferler=JSON.parse(localStorage.getItem("seferler"));
let secilen=[];

function yukleSofor(){
  sofor.innerHTML="";
  users.filter(x=>x.role==="sofor").forEach(s=>{
    sofor.innerHTML+=`<option value="${s.user}">${s.user}</option>`;
  });
}
yukleSofor();

for(let h=5;h<24;h++){
  for(let m=0;m<60;m+=5){
    const s=`${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}`;
    const b=document.createElement("button");
    b.innerText=s; b.className="time";
    b.onclick=()=>{
      b.classList.toggle("active");
      secilen.includes(s)?secilen=secilen.filter(x=>x!==s):secilen.push(s);
    };
    saatler.appendChild(b);
  }
}

function ata(){
  secilen.forEach(s=>{
    seferler.push({
      hat:hat.value,
      yon:yon.value,
      arac:arac.value,
      sofor:sofor.value,
      saat:s,
      durum:"Bekliyor"
    });
  });
  localStorage.setItem("seferler",JSON.stringify(seferler));
  secilen=[];
  document.querySelectorAll(".active").forEach(x=>x.classList.remove("active"));
  listele();
}

function ekle(){
  users.push({user:su.value,pin:sp.value,role:"sofor"});
  localStorage.setItem("users",JSON.stringify(users));
  yukleSofor();
  su.value=""; sp.value="";
}

function listele(){
  gTablo.innerHTML="<tr><th>Hat</th><th>Saat</th><th>Şoför</th></tr>";
  dTablo.innerHTML="<tr><th>Hat</th><th>Saat</th><th>Şoför</th></tr>";
  seferler.forEach(s=>{
    const row=`<tr><td>${s.hat}</td><td>${s.saat}</td><td>${s.sofor}</td></tr>`;
    s.yon==="Gidiş"?gTablo.innerHTML+=row:dTablo.innerHTML+=row;
  });
}
listele();

function cikis(){
  localStorage.removeItem("aktif");
  location.href="index.html";
}
</script>

</body>
</html>

