<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Şoför</title>
<style>
body{
  font-family:Arial;
  background:#f8fafc;
  padding:20px
}
.card{
  background:white;
  padding:10px;
  margin-bottom:10px;
  border:1px solid #ddd;
}
button{
  margin-top:5px;
  padding:5px 10px;
}
</style>
</head>
<body>

<h3>Şoför Paneli</h3>

<div id="g"></div>
<div id="d"></div>

<button onclick="cikis()">Çıkış</button>

<script>
const aktif = JSON.parse(localStorage.getItem("aktif"));
let seferler = JSON.parse(localStorage.getItem("seferler")) || [];

function render(){
  g.innerHTML = "<h4>Gidiş</h4>";
  d.innerHTML = "<h4>Dönüş</h4>";

  seferler
    .filter(s => s.sofor === aktif.user)
    .forEach(s => {

      const div = `
        <div class="card">
          <b>Hat:</b> ${s.hat}<br>
          <b>Araç:</b> ${s.arac}<br>
          <b>Saat:</b> ${s.saat}<br>
          <b>Durum:</b> ${s.durum}<br>
          ${
            s.durum === "Bekliyor"
            ? `<button onclick="yapildi('${s.id}')">Yapıldı</button>`
            : ""
          }
        </div>
      `;

      if(s.yon === "gidis"){
        g.innerHTML += div;
      }else{
        d.innerHTML += div;
      }
    });
}

function yapildi(id){
  seferler = seferler.map(s=>{
    if(s.id === id){
      return { ...s, durum: "Yapıldı" };
    }
    return s;
  });

  localStorage.setItem("seferler", JSON.stringify(seferler));
  render();
}

function cikis(){
  localStorage.removeItem("aktif");
  location.href="index.html";
}

render();
</script>

</body>
</html>

